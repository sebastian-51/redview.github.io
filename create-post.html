<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nueva Observaci√≥n - REDVIEWER</title>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/12.9.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/12.9.0/firebase-database-compat.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            color: #fff;
            min-height: 100vh;
            padding-bottom: 70px;
        }

        /* Navbar */
        .navbar {
            background: rgba(15, 12, 41, 0.95);
            padding: 15px 5%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.5);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .logo {
            font-size: 1.6em;
            font-weight: bold;
            color: #667eea;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-links {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .nav-links a {
            color: #fff;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
            font-size: 0.95em;
            white-space: nowrap;
        }

        .nav-links a:hover {
            color: #667eea;
        }

        .btn {
            padding: 8px 20px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            font-size: 0.9em;
            white-space: nowrap;
        }

        .btn-logout {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
        }

        .btn-logout:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
        }

        /* Create Post Container */
        .create-post-container {
            max-width: 900px;
            margin: 30px auto;
            padding: 0 15px;
        }

        .create-post-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .create-post-header h1 {
            font-size: 2.3em;
            margin-bottom: 12px;
            background: linear-gradient(45deg, #667eea, #764ba2, #f093fb);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .create-post-header p {
            color: #a0a0c0;
            font-size: 1.05em;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
        }

        .create-post-form {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .form-section {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .form-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .section-title {
            font-size: 1.4em;
            color: #667eea;
            margin-bottom: 18px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-group {
            margin-bottom: 18px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #e0e0ff;
            font-size: 0.95em;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1) !important;
            color: #ffffff !important;
            font-size: 15px;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            background: rgba(255, 255, 255, 0.15) !important;
            box-shadow: 0 0 12px rgba(102, 126, 234, 0.3);
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }

        .form-hint {
            color: #a0a0c0;
            font-size: 0.85em;
            margin-top: 6px;
            font-style: italic;
        }

        /* Satellite Info Cards */
        .satellite-info {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 25px;
        }

        .satellite-info-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .satellite-info-header h2 {
            font-size: 1.6em;
            color: #667eea;
            margin-bottom: 8px;
        }

        .satellite-info-header p {
            color: #a0a0c0;
            font-size: 0.95em;
            line-height: 1.5;
        }

        .satellite-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
            gap: 15px;
        }

        .satellite-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 18px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s;
        }

        .satellite-card:hover {
            background: rgba(102, 126, 234, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(102, 126, 234, 0.3);
        }

        .satellite-card.selected {
            background: rgba(102, 126, 234, 0.3);
            border-color: #667eea;
            transform: scale(1.03);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        .satellite-card-icon {
            font-size: 2.5em;
            margin-bottom: 8px;
            text-align: center;
        }

        .satellite-card-name {
            font-size: 1.2em;
            font-weight: bold;
            color: #667eea;
            text-align: center;
            margin-bottom: 8px;
        }

        .satellite-card-type {
            text-align: center;
            color: #a0a0c0;
            font-size: 0.9em;
            margin-bottom: 12px;
            font-style: italic;
        }

        .satellite-details {
            background: rgba(102, 126, 234, 0.15);
            border-radius: 8px;
            padding: 10px;
            margin-top: 8px;
            font-size: 0.85em;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 4px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .detail-row:last-child {
            border-bottom: none;
        }

        .detail-label {
            color: #a0a0c0;
        }

        .detail-value {
            color: #667eea;
            font-weight: bold;
        }

        .select-btn {
            width: 100%;
            margin-top: 10px;
            padding: 8px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9em;
        }

        .select-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        /* Image Upload */
        .image-upload {
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            background: rgba(255, 255, 255, 0.03);
            transition: all 0.3s;
            cursor: pointer;
            margin-top: 10px;
        }

        .image-upload:hover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
        }

        .image-upload-icon {
            font-size: 2.5em;
            margin-bottom: 12px;
            color: #667eea;
        }

        .image-upload-text {
            font-size: 1.05em;
            margin-bottom: 8px;
            color: #e0e0ff;
        }

        .image-upload-hint {
            color: #a0a0c0;
            font-size: 0.85em;
        }

        .image-upload input {
            display: none;
        }

        .image-preview {
            margin-top: 15px;
            display: none;
        }

        .image-preview img {
            width: 100%;
            border-radius: 10px;
            max-height: 300px;
            object-fit: cover;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        /* Location Helper */
        .location-helper {
            background: rgba(102, 126, 234, 0.15);
            border: 1px solid rgba(102, 126, 234, 0.4);
            border-radius: 10px;
            padding: 12px;
            margin-top: 10px;
            font-size: 0.85em;
        }

        .location-helper p {
            margin-bottom: 8px;
            color: #e0e0ff;
        }

        .location-example {
            background: rgba(255, 255, 255, 0.1);
            padding: 6px;
            border-radius: 5px;
            font-family: monospace;
            color: #667eea;
            margin-top: 5px;
            font-size: 0.9em;
        }

        /* Buttons */
        .form-buttons {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-top: 25px;
            flex-wrap: wrap;
        }

        .btn-submit {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 12px 35px;
            font-size: 1.05em;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            min-width: 150px;
        }

        .btn-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
        }

        .btn-cancel {
            background: transparent;
            color: #a0a0c0;
            padding: 12px 30px;
            font-size: 1.05em;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            min-width: 140px;
        }

        .btn-cancel:hover {
            background: rgba(255, 255, 255, 0.05);
            color: #ff6b6b;
            border-color: #ff6b6b;
        }

        .error-message {
            background: rgba(255, 107, 107, 0.2);
            border: 1px solid #ff6b6b;
            color: #ff6b6b;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 18px;
            display: none;
            font-size: 0.9em;
        }

        /* Footer */
        footer {
            background: rgba(10, 8, 27, 0.95);
            padding: 20px 5%;
            text-align: center;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 30px;
            font-size: 0.85em;
        }

        .footer-content {
            max-width: 1000px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 20px;
            margin-bottom: 15px;
        }

        .footer-section h3 {
            color: #667eea;
            margin-bottom: 12px;
            font-size: 1.1em;
        }

        .footer-section a {
            color: #a0a0c0;
            text-decoration: none;
            display: block;
            margin: 5px 0;
            transition: color 0.3s;
            font-size: 0.9em;
        }

        .footer-section a:hover {
            color: #667eea;
        }

        .creator-name {
            color: #667eea;
            font-weight: bold;
        }

        .creator-russian {
            color: #764ba2;
            font-weight: bold;
            margin-top: 3px;
            display: block;
            font-size: 0.9em;
        }

        .copyright {
            margin-top: 12px;
            color: #a0a0c0;
            padding-top: 12px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Loading state */

        /* Loading state */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 12, 41, 0.96);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            display: none;
            flex-direction: column;
            gap: 20px;
        }
      /*  .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 12, 41, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            display: none;
        }
*/
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(102, 126, 234, 0.3);
            border-top-color: #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-text {
            color: white;
            margin-top: 15px;
            font-size: 1.1em;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .navbar {
                flex-direction: column;
                gap: 10px;
                padding: 12px;
            }

            .nav-links {
                flex-direction: column;
                gap: 6px;
                align-items: flex-start;
            }

            .logo {
                font-size: 1.4em;
            }

            .create-post-container {
                margin: 20px auto;
                padding: 0 10px;
            }

            .create-post-header h1 {
                font-size: 1.9em;
            }

            .create-post-header p {
                font-size: 0.95em;
                padding: 0 5px;
            }

            .create-post-form {
                padding: 20px 15px;
            }

            .section-title {
                font-size: 1.3em;
            }

            .satellite-cards {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }

            .form-buttons {
                flex-direction: column;
            }

            .btn-submit,
            .btn-cancel {
                width: 100%;
                max-width: 300px;
                padding: 12px;
            }

            footer {
                padding: 15px 5%;
                font-size: 0.8em;
            }

            .footer-content {
                grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
                gap: 15px;
            }
        }

        @media (max-width: 480px) {
            .satellite-cards {
                grid-template-columns: 1fr;
            }

            .create-post-header h1 {
                font-size: 1.7em;
            }

            .section-title {
                font-size: 1.2em;
            }

            .form-group input,
            .form-group select,
            .form-group textarea {
                padding: 10px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <a href="index.html" class="logo">üõ∞Ô∏è REDVIEWER</a>
        <div class="nav-links">
            <a href="index.html">Inicio</a>
            <a href="profile.html">Perfil</a>
            <a href="create-post.html">Nueva Observaci√≥n</a>
            <a href="faq.html" style="display: flex; align-items: center; gap: 5px; font-size: 0.9em;">‚ùì Ayuda</a>
        </div>
        <button class="btn btn-logout" onclick="logout()">Cerrar Sesi√≥n</button>
    </nav>

    <!-- Create Post Container -->
    <div class="create-post-container">
        <div class="create-post-header">
            <h1>üî≠ Nueva Observaci√≥n</h1>
            <p>Comparta su avistamiento con la comunidad de REDVIEWER</p>
        </div>

        <form class="create-post-form" id="observationForm">
            <div class="error-message" id="errorMessage"></div>

            <!-- Satellite Info Cards -->
            <div class="satellite-info">
                <div class="satellite-info-header">
                    <h2>üõ∞Ô∏è Selecciona un Sat√©lite</h2>
                    <p>Haz clic en el sat√©lite que observaste para obtener informaci√≥n y seleccionarlo</p>
                </div>

                <div class="satellite-cards" id="satelliteCards">
                    <!-- Los sat√©lites se cargar√°n din√°micamente -->
                </div>
            </div>

            <!-- Basic Information -->
            <div class="form-section">
                <h2 class="section-title">üõ∞Ô∏è Informaci√≥n B√°sica</h2>

                <div class="form-group">
                    <label for="objectType">Tipo de Objeto *</label>
                    <select id="objectType" required style="color: white; background: rgba(255, 255, 255, 0.1);">
                        <option value="" style="color: #a0a0c0; background: #1a1a2e;">Selecciona un tipo de objeto...</option>
                        <option value="satellite" style="color: #333; background: white;">Sat√©lite</option>
                        <option value="iss" style="color: #333; background: white;">ISS (Estaci√≥n Espacial Internacional)</option>
                        <option value="starlink" style="color: #333; background: white;">Constelaci√≥n Starlink</option>
                        <option value="rocket" style="color: #333; background: white;">Cohete / Lanzamiento</option>
                        <option value="meteor" style="color: #333; background: white;">Meteorito / B√≥lido</option>
                        <option value="space_debris" style="color: #333; background: white;">Basura Espacial</option>
                        <option value="other" style="color: #333; background: white;">Otro objeto espacial</option>
                    </select>
                    <div class="form-hint">Selecciona el tipo de objeto que observaste</div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="observationDate">Fecha de Observaci√≥n *</label>
                        <input type="date" id="observationDate" required>
                    </div>
                    <div class="form-group">
                        <label for="observationTime">Hora de Observaci√≥n *</label>
                        <input type="time" id="observationTime" required>
                    </div>
                </div>
            </div>

            <!-- Ubicaci√≥n -->
            <div class="form-section">
                <h2 class="section-title">üìç Ubicaci√≥n</h2>

                <div class="form-group">
                    <label for="location">Coordenadas GPS (Latitud, Longitud) *</label>
                    <input type="text" id="location" placeholder="Ej: 19.4326, -99.1332" required>
                    <div class="form-hint">Puedes obtener tus coordenadas desde Google Maps</div>
                    
                    <div class="location-helper">
                        <p><strong>¬øC√≥mo obtener tus coordenadas?</strong></p>
                        <ol style="margin-left: 15px; color: #e0e0ff; font-size: 0.85em;">
                            <li>Abre Google Maps en tu navegador √ì abre Yandex maps</li>
                            <li>Haz clic derecho en tu ubicaci√≥n</li>
                            <li>Copia las coordenadas que aparecen</li>
                        </ol>
                        <div class="location-example">Ejemplo: 19.4326, -99.1332</div>
                    </div>
                </div>
            </div>

            <!-- Descripci√≥n -->
            <div class="form-section">
                <h2 class="section-title">üìù Descripci√≥n</h2>

                <div class="form-group">
                    <label for="description">Describe tu Observaci√≥n *</label>
                    <textarea id="description" placeholder="Describe lo que viste, condiciones del cielo, duraci√≥n, brillo, direcci√≥n, etc." required></textarea>
                    <div class="form-hint">S√© lo m√°s detallado posible para ayudar a otros observadores</div>
                </div>

                <div class="form-group">
                    <label for="equipment">Equipo Utilizado (Opcional)</label>
                    <input type="text" id="equipment" placeholder="Ej: Telescopio Celestron, Binoculares 10x50, C√°mara DSLR, etc.">
                    <div class="form-hint">Especifica si usaste alg√∫n equipo especial</div>
                </div>
            </div>

            <!-- Foto -->
            <div class="form-section">
                <h2 class="section-title">üì∏ Foto de la Observaci√≥n</h2>

                <div class="image-upload" onclick="document.getElementById('photoInput').click()">
                    <div class="image-upload-icon">üì∑</div>
                    <div class="image-upload-text">Haz clic para subir una foto</div>
                    <div class="image-upload-hint">o arrastra y suelta tu imagen aqu√≠</div>
                    <input type="file" id="photoInput" accept="image/*" onchange="previewImage(event)">
                </div>

                <div class="image-preview" id="imagePreview">
                    <img id="previewImg" src="" alt="Vista previa">
                </div>
            </div>

            <!-- Submit Buttons -->
            <div class="form-buttons">
                <button type="button" class="btn-cancel" onclick="window.location.href='profile.html'">Cancelar</button>
                <button type="submit" class="btn-submit">üöÄ Publicar Observaci√≥n</button>
            </div>
        </form>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div class="loading-text" id="loadingText">Publicando tu observaci√≥n espacial...<br>¬°Preparando el lanzamiento! üåå</div>
    </div>

    <!-- <div class="loading-overlay" id="loadingOverlay">
        <div style="text-align: center;">
            <div class="loading-spinner"></div>
            <div class="loading-text">Publicando observaci√≥n...</div>
        </div>
    </div> -->

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>REDVIEWER</h3>
                <h4>–ö–†–ê–°–ù–´–ô –ó–†–ò–¢–ï–õ–¨</h4>
                <h3>Y aunque eramos de distintas galaxias, tu fuerza de atracci√≥n me sacaba de √≥rbita</h3>
                <p>La red social para observadores de sat√©lites</p>
                <p>Conectando el cielo con la Tierra</p>
            </div>
            <div class="footer-section">
                <h3>Enlaces</h3>
                <a href="index.html">Inicio</a>
                <a href="profile.html">Tu Perfil</a>
                <a href="create-post.html">Nueva Observaci√≥n</a>
            </div>
            <div class="footer-section">
                <h3>Ayuda</h3>
                <a href="faq.html">‚ùì Preguntas Frecuentes</a>
                <a href="faq.html#satelites">Gu√≠a de Observaci√≥n</a>
                <a href="faq.html#contacto">Contacto</a>
            </div>
            <div class="footer-section">
                <h3>Legal</h3>
                <a href="#">T√©rminos y Condiciones</a> <!--Por desarrollar-->
                <a href="#">Pol√≠tica de Privacidad</a>
                <a href="#">Cookies</a>
            </div>
        </div>
        <div class="copyright">
            <p>Creado por <span class="creator-name">Sebastian Sifuentes Zavala</span></p>
            <p class="creator-russian">–°–æ–∑–¥–∞–Ω–æ –°–µ–±–∞—Å—Ç—å—è–Ω–æ–º –°–∏—Ñ—É—ç–Ω—Ç–µ—Å –ó–∞–≤–∞–ª–∞</p>
            <p>&copy; 2026 REDVIEWER. Todos los derechos reservados.</p>
        </div>
    </footer>

    <script>
        // ------------------ssz------------------------
        // Confirguramos el FireBase
        // --------------------------------------------
        const firebaseConfig = {
            apiKey: "AIzaSyBqir3yVi6h7tjCvd6A8w9oIDtvtmYa2OE",
            authDomain: "redview-59ebc.firebaseapp.com",
            databaseURL: "https://redview-59ebc-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "redview-59ebc",
            storageBucket: "redview-59ebc.firebasestorage.app",
            messagingSenderId: "618471660309",
            appId: "1:618471660309:web:91c0b1a11d71925802671c"
        };

        // Inicializar Firebase
        try {
            firebase.initializeApp(firebaseConfig);
            console.log('‚úÖ Firebase inicializado correctamente');
        } catch (error) {
            console.error('‚ùå Error al inicializar Firebase:', error);
            alert('Error de conexi√≥n con REDVIEWER. Verifica tu conexi√≥n a internet.');
        }

        // Datos de sat√©lites con informaci√≥n √∫til
        const satellites = [
            {
                id: 'iss',
                name: 'ISS',
                icon: 'üõ∞Ô∏è',
                type: 'iss',
                altitude: '408 km',
                velocity: '27,600 km/h',
                brightness: '-3.5 a -1.5 (muy brillante)',
                visibility: '5-6 minutos',
                description: 'Estaci√≥n Espacial Internacional - Visible casi todas las noches'
            },
            {
                id: 'starlink',
                name: 'Starlink',
                icon: 'üì°',
                type: 'starlink',
                altitude: '550 km',
                velocity: '27,000 km/h',
                brightness: '+2.0 a +4.0',
                visibility: '3-5 minutos',
                description: 'Constelaci√≥n de sat√©lites de SpaceX - Aparecen en cadena'
            },
            {
                id: 'hubble',
                name: 'Hubble',
                icon: 'üî≠',
                type: 'satellite',
                altitude: '547 km',
                velocity: '27,000 km/h',
                brightness: '+3.0',
                visibility: '2-4 minutos',
                description: 'Telescopio Espacial Hubble - Menos brillante que la ISS'
            },
            {
                id: 'noaa19',
                name: 'NOAA 19',
                icon: 'üå§Ô∏è',
                type: 'satellite',
                altitude: '864 km',
                velocity: '26,500 km/h',
                brightness: '+3.5',
                visibility: '4-6 minutos',
                description: 'Sat√©lite meteorol√≥gico - Requiere cielo oscuro'
            },
            {
                id: 'tiangong',
                name: 'Tiangong',
                icon: 'üá®üá≥',
                type: 'satellite',
                altitude: '390 km',
                velocity: '27,600 km/h',
                brightness: '-1.0 a +1.0',
                visibility: '3-5 minutos',
                description: 'Estaci√≥n Espacial China - Visible ocasionalmente'
            },
            {
                id: '–°–æ—é–∑',
                name: '–°–æ—é–∑',
                icon: 'üöÄ',
                type: 'rocket',
                altitude: '400 km',
                velocity: '27,600 km/h',
                brightness: 'Variable',
                visibility: 'Durante lanzamientos',
                description: '–†–û–°–°–ò–ô–°–ö–ò–ô –∫–æ—Å–º–∏—á–µ—Å–∫–∏–π –∫–æ—Ä–∞–±–ª—å - Visible durante misiones'
            }
        ];

        let selectedSatellite = null;
        let userLocation = null;

        // Sat√©lites en tarjetas
        function loadSatelliteCards() {
            const container = document.getElementById('satelliteCards');
            container.innerHTML = satellites.map(sat => `
                <div class="satellite-card" onclick="selectSatellite('${sat.id}')">
                    <div class="satellite-card-icon">${sat.icon}</div>
                    <div class="satellite-card-name">${sat.name}</div>
                    <div class="satellite-card-type">${sat.type}</div>
                    <div class="satellite-details">
                        <div class="detail-row">
                            <span class="detail-label">Altitud:</span>
                            <span class="detail-value">${sat.altitude}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Velocidad:</span>
                            <span class="detail-value">${sat.velocity}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Brillo:</span>
                            <span class="detail-value">${sat.brightness}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Duraci√≥n:</span>
                            <span class="detail-value">${sat.visibility}</span>
                        </div>
                    </div>
                    <button type="button" class="select-btn">‚úÖ Seleccionar</button>
                </div>
            `).join('');
        }

        // Seleccionar sat√©lite
        function selectSatellite(satId) {
            const cards = document.querySelectorAll('.satellite-card');
            cards.forEach(card => card.classList.remove('selected'));
            
            const selectedCard = Array.from(cards).find(card => 
                card.getAttribute('onclick').includes(`'${satId}'`)
            );
            
            if (selectedCard) {
                selectedCard.classList.add('selected');
            }
            
            selectedSatellite = satellites.find(s => s.id === satId);
            
            // Rellenar de forma autom√°tica el fomrulario 
            document.getElementById('objectType').value = selectedSatellite.type;
            
            // Rellenar descripci√≥n sugerida
            const descInput = document.getElementById('description');
            if (!descInput.value) {
                descInput.value = `Avistamiento de ${selectedSatellite.name} (${selectedSatellite.description}). Visible durante ${selectedSatellite.visibility} con brillo de ${selectedSatellite.brightness}.`;
            }
            
            alert(`‚úÖ ${selectedSatellite.name} seleccionado!\n\nInformaci√≥n del sat√©lite:\n‚Ä¢ Altitud: ${selectedSatellite.altitude}\n‚Ä¢ Velocidad: ${selectedSatellite.velocity}\n‚Ä¢ Brillo: ${selectedSatellite.brightness}\n\nLa descripci√≥n ha sido rellenada autom√°ticamente.`);
        }

        // Verificar sesi√≥n
        function checkSession() {
            const currentUser = localStorage.getItem('currentUser');
            if (!currentUser) {
                window.location.href = 'login.html';
                return null;
            }
            return JSON.parse(currentUser);
        }

        // Cerrar sesi√≥n
        function logout() {
            localStorage.removeItem('currentUser');
            window.location.href = 'index.html';
        }

        // Vista previa de imagen
        function previewImage(event) {
            const file = event.target.files[0];
            const preview = document.getElementById('imagePreview');
            const previewImg = document.getElementById('previewImg');

            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    previewImg.src = e.target.result;
                    preview.style.display = 'block';
                };
                reader.readAsDataURL(file);
            }
        }

        // Validar coordenadas
        function validateCoordinates(coords) {
            const pattern = /^-?\d{1,2}(\.\d+)?,\s*-?\d{1,3}(\.\d+)?$/;
            return pattern.test(coords.trim());
        }

        // Crear post en Firebase
        function createPost(user, imageUrl) {
            const loadingOverlay = document.getElementById('loadingOverlay');
            loadingOverlay.style.display = 'flex';
            
            const observationDate = document.getElementById('observationDate').value;
            const observationTime = document.getElementById('observationTime').value;
            const observationDateTime = `${observationDate}T${observationTime}:00`;
            
            const newPostRef = firebase.database().ref('posts').push();
            
            // Guardamos nombre de usuario y avatar para saber quien es
            const newPost = {
                id: newPostRef.key,
                userId: user.id,
                username: user.username,  // ‚úÖ Guardar nombre del autor
                avatar: user.avatar || user.username.charAt(0).toUpperCase(), // ‚úÖ Guardar avatar
                objectType: document.getElementById('objectType').value,
                time: observationDateTime,
                location: document.getElementById('location').value.trim(),
                description: document.getElementById('description').value,
                equipment: document.getElementById('equipment').value || 'A simple vista',
                image: imageUrl,
                likes: 0,
                comments: [],
                createdAt: new Date().toISOString()
            };
            
            // Guardar en Firebase *Checar siempre n√∫mero de entradas restantes en el software 
            newPostRef.set(newPost)
                .then(() => {
                    // Actualizar contador de posts del usuario en localStorage
                    user.posts = (user.posts || 0) + 1;
                    localStorage.setItem('currentUser', JSON.stringify(user));
                    
                    loadingOverlay.style.display = 'none';
                    
                    alert('‚úÖ ¬°Observaci√≥n publicada exitosamente!\n\nAhora todos pueden ver su avistamiento en la p√°gina principal.');
                    window.location.href = 'index.html';
                })
                .catch((error) => {
                    loadingOverlay.style.display = 'none';
                    console.error('Error al guardar post:', error);
                    alert('‚ùå Error al publicar. Verifique su conexi√≥n a internet e intente nuevamente.');
                });
        }

        // Manejar formulario
        document.getElementById('observationForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const user = checkSession();
            if (!user) return;

            const errorMessage = document.getElementById('errorMessage');
            errorMessage.style.display = 'none';

            // Obtener valores
            const objectType = document.getElementById('objectType').value;
            const observationDate = document.getElementById('observationDate').value;
            const observationTime = document.getElementById('observationTime').value;
            const location = document.getElementById('location').value;
            const description = document.getElementById('description').value;
            const equipment = document.getElementById('equipment').value;
            const photoInput = document.getElementById('photoInput').files[0];

            // Validation
            if (!objectType) {
                showError('Por favor selecciona un tipo de objeto');
                return;
            }

            if (!observationDate || !observationTime) {
                showError('Por favor completa la fecha y hora');
                return;
            }

            if (!location || !validateCoordinates(location)) {
                showError('Por favor ingresa coordenadas v√°lidas (Lat, Long)');
                return;
            }

            if (!description || description.length < 20) {
                showError('La descripci√≥n debe tener m√≠nimo 20 caracteres');
                return;
            }

            // Procesar imagen
            let imageUrl = '';
            if (photoInput) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    createPost(user, e.target.result);
                };
                reader.readAsDataURL(photoInput);
            } else {
                createPost(user, '');
            }
        });

        // Show Error
        function showError(message) {
            const errorMessage = document.getElementById('errorMessage');
            errorMessage.textContent = message;
            errorMessage.style.display = 'block';
            errorMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        // Inicializar
        window.onload = function() {
            console.log('üöÄ Iniciando REDVIEWER - Crear Observaci√≥n...');
            
            checkSession();
            loadSatelliteCards();
            
            // Establecer fecha y hora actuales por defecto del sistema
            const now = new Date();
            document.getElementById('observationDate').value = now.toISOString().split('T')[0];
            document.getElementById('observationTime').value = now.toTimeString().slice(0, 5);
            
            // Determinar ubicaci√≥n del usuario
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        userLocation = {
                            lat: position.coords.latitude,
                            lon: position.coords.longitude
                        };
                        document.getElementById('location').value = 
                            `${userLocation.lat.toFixed(4)}, ${userLocation.lon.toFixed(4)}`;
                    },
                    (error) => {
                        console.log('No se pudo obtener la ubicaci√≥n:', error);
                    },
                    { enableHighAccuracy: false, timeout: 5000 }
                );
            }
            
            console.log('‚úÖ REDVIEWER - Crear Observaci√≥n cargado correctamente');
        };
    </script>
</body>
</html>
